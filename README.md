Much inspiration for the parser taken from cjhveal's lispr.
